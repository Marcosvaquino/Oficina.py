<script>
  function openModalCarros(id) {
    
    var carros = JSON.parse('{{ carros | tojson | safe }}');
    
    function encontrarCarroPorId(carros, id) {
      try{
        for (var i = 0; i < carros.length; i++) {
          if (carros[i].id == id) {
            return carros[i];
          }
        }      
        return null; 
      }catch(e){
        return null;
      }
    }

    function formatarData(d) {
      try{
        var dataSelecionada = new Date(d);
        var dia = dataSelecionada.getDate().toString().padStart(2, '0');
        var mes = (dataSelecionada.getMonth() + 1).toString().padStart(2, '0');
        var ano = dataSelecionada.getFullYear();
        var dataFormatada = dia + '/' + mes + '/' + ano;
        return dataFormatada;
      }catch(e){
        return '';
      }
    }
    
    if (id == '0') {
        document.getElementsByName('id')[0].value = '0';                      
        document.getElementsByName('id_cliente')[0].value = '';
        document.getElementsByName('id_oficina')[0].value = '';
        
        document.getElementsByName('placa')[0].value = '';
        document.getElementsByName('modelo')[0].value = '';
        document.getElementsByName('marca')[0].value = '';
        document.getElementsByName('cor')[0].value = '';
        document.getElementsByName('ano_fabricacao')[0].value = '';
        document.getElementsByName('ano_modelo')[0].value = '';
      
        document.getElementsByName('data_cadastro')[0].value = '';
        document.getElementsByName('data_atualizacao')[0].value = '';
      document.getElementById('modalCarro').style.display = 'block';
      return;
    }else{
      
      var carroEncontrado = encontrarCarroPorId(carros, id);

      if (carroEncontrado == null) {
        alert('Carro nÃ£o encontrado');
        return;
      }

      try{
        document.getElementsByName('id')[0].value = carroEncontrado.id;
        document.getElementsByName('id_cliente')[0].value = carroEncontrado.id_cliente;
        document.getElementsByName('id_oficina')[0].value = carroEncontrado.id_oficina;
        
        document.getElementsByName('placa')[0].value = carroEncontrado.placa;
        document.getElementsByName('modelo')[0].value = carroEncontrado.modelo;
        document.getElementsByName('marca')[0].value = carroEncontrado.marca;
        document.getElementsByName('cor')[0].value = carroEncontrado.cor;
        document.getElementsByName('ano_fabricacao')[0].value = carroEncontrado.ano_fabricacao;
        document.getElementsByName('ano_modelo')[0].value = carroEncontrado.ano_modelo;

        document.getElementsByName('data_cadastro')[0].value = formatarData(carroEncontrado.data_criacao);
        document.getElementsByName('data_atualizacao')[0].value = formatarData(carroEncontrado.data_atualizacao);
      }catch(e){
        alert('Erro ao preencher os campos' + e);
      }    
      document.getElementById('modalCarro').style.display = 'block';
    }

  }

  function closeModalCarros() {
    document.getElementById("modalCarro").style.display = "none";
  }

</script>